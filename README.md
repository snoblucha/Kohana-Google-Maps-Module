# Kohana Google Maps Module V1.3
With this module you can easily add a Google Map to your Kohana installation!

The Google Map module has NO dependency to other modules! Just jQuery. For multiple maps
compatibility.

## Features

* Display a Google-Map by just echo'ing an instance of the "Gmap" class
* Setting several map-types (road, satellite, hybrid and terrain)
* Setting sensor-parameter (for mobile devices)
* Adding markers to the map (including custom icon and Google Maps popups)
* Adding polylines to the map
* Adding polygons to the map
* Setting the positions and types for the map-controls

## Features to come
The following features shall be implemented during development:

* Cleaning up the Google Map-view (Maybe moving the javascript to a sub-views?)

## Usage
The usage of this module is as easy as it could be! Simply activate the module in your bootstrap.php

	/**
	 * Enable modules. Modules are referenced by a relative or absolute path.
	 */
	Kohana::modules(array(
		// ...
		'gmap'       => MODPATH.'gmap',       // A simple google-maps module
	));

Then you'll just echo an instance of the gmap class in your action... For example:

	public function action_index()
	{
		$this->template->map = Gmap::factory();
	} // function

This is a more advanced example with usage of various options...

	public function action_index()
	{
            $gmap = Gmap::factory('map1');

            //set map type
            $gmap->setMaptype(Gmap_Maptype::HYBRID());

            $gmap->getControls()->getMaptype()->setType(Gmap_Controls_Maptype::TYPE_HORIZONTAL);

            //positions of controls - maptype and navigation
            $gmap->getControls()->getMaptype()->setPosition(Gmap_Controls_Maptype::POSITION_BOTTOM_LEFT);

            //hide the controls
            $gmap->getControls()->getNavigation()->setDisplay(false);

            $gmap->setZoom(11);
            $gmap->addMarker(Gmap_Marker::factory('test', 50.6, 14.0)->setContent('Test content'));
            $gmap->addMarker(Gmap_Marker::factory('test_no_content', 50.6, 14.5));
            $gmap->addMarker(Gmap_Marker::factory('test_no_content_icon', 50.2, 14.4)->setIcon('/img/heating-and-aircon.png'));

            //geocoding
            $gmap->addGeocode(Gmap_Geocode::geocode('adresa','Anezky Ceske 629/3, Usti nad Labem'));

            //polyline

            $polygon = new Gmap_Polygon('square');
            $polygon->addPoint(49, 14)->addPoint(48, 14)->addPoint(48, 13)->addPoint(49, 13);
            $polygon->setFillColor('#ff00ff')->setFillOpacity(0.25)->setStrokeColor("#00ff00")->setStrokeOpacity(0.75)->setStrokeWeight(2.5);
            $gmap->addPolygon($polygon);


            //second map
            $gmap2 = Gmap::factory('map2')->addMarker(Gmap_Marker::factory('Test on 2 map', 50.7, 14.0)->setContent('Marker on second map'));

            $this->template->content = $gmap->render() . $gmap2->render();
        } // function



## Javascript access

In javascript the gmaps variable is created. It is javascript object see `views/gmap_enable.php`.
Each map instance is accessible in javascript by `gmaps[instance_name]`. If `instance_name`
is not explicitly set in constructor or later in the code, autogenerated value is used.

###Javascript constructor

    function Gmap(options){

        this.options = options;
        this.polyline_coords = {};
        this.polylines = {};
        this.polygons = {};
        this.polygon_coords = {};
        this.markers = {};
        this.info_windows = {};
        this.geocode_request = {};
        this.geocode_result = {};
    };

##Variables in javascript

    Gmap::factory(array('instance_name'=>'myMap'))
            ->add_marker_address('my_marker','address, city')
            ->render();

- In javascript you will then have varible `gmaps['myMap']`.
- `gmaps['myMap'].map` is instance of `google.maps.Map`.
- `gmaps['markers']['my_marker']` is instance of `google.maps.Marker`.
- `In gmaps['myMap'].geocode_result['my_marker']` is result from the call to `geocoder.geocode`


